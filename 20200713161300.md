['

发布了想法: IBM 招聘云工程师，任职资格写着“至少12…
<p>IBM 招聘云工程师，任职资格写着“至少12年 Kubernetes 经验”。 <br><br><a href="http://link.zhihu.com/?target=https%3A//intellijobs.ai/job/IBMCloud-Native-Infrastructure-Engineer-Architect-bvJJ6yraexfWOk1nMRKP-bvJJ6yraexfWOk1nMRKP" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">
https://</span><span class="visible">intellijobs.ai/job/IBMC</span><span class="invisible">loud-Native-Infrastructure-Engineer-Architect-bvJJ6yraexfWOk1nMRKP-bvJJ6yraexfWOk1nMRKP</span><span class="ellipsis"></span></a><br><br>Required Technical and Professional Expertise<br>Minimum 12+ years’ experience in Kubernetes administration and management</p><p><img src="https://pic2.zhimg.com/50/v2-3a8c2505d1870adbef44f5e0fc109b5f_qhd.jpg" referrerpolicy="no-referrer"></p>Sun, 12 Jul 2020 16:25:07 GMT
https://www.zhihu.com/pin/1265803647713193984
https://www.zhihu.com/pin/1265803647713193984                                                


赞同了回答: 为什么有的人特别喜欢独处？<p>我比较喜欢独处，只是个喜欢简单的普通人。我不喜欢太吵闹，不擅长处理各种麻烦的人际关系，平时也不太喜欢聚在一起吵吵闹闹，但并不会因为我喜欢自己待着就和朋友疏远了</p><p>我感觉找到合拍的人在一起是一件特别幸运的事情，但大多数时候也不一定能找着，大多数喜欢热闹，人们也喜欢性格开朗的人，我觉着倒也没必要为了迎合别人假装自己在团体中很快乐，要假装笑的很爽朗，这样很累啊，和许多人凑合着吵吵闹闹，会让我变得自己不是自己，独处的时间可以让我喘口气，反思自己，找回自己</p>Sun, 12 Jul 2020 15:09:07 GMT
https://www.zhihu.com/question/25415260/answer/1333637107
https://www.zhihu.com/question/25415260/answer/1333637107                                                风筝


收藏了回答: 感觉中国程序员前景一片灰暗，是这样吗？<p>嗯，是的。</p><p>但是并不是因为技术更新快，涌入人员多。</p><p>国外的软件行业这些问题都有，但是并没有内卷到这种程度。</p><p>如果说是因为国外人少，我承认，有这个原因，但绝不是全部。</p><p>我国互联网行业的管理其实是特别具有中国特色的，换句话说跟国际不接轨。越来越多海归的互联网从业人员可以证明的，早年建立当今这套管理体系的人，如果打着引进国外先进经验的旗号，那绝对是挂着羊头卖狗肉。</p><p>首先，全体KPI。国内的程序员羡慕国外的同行不用996，没有一个接一个的迭代，有时间学习新技术，work life balance. 你想过那源源不断的需求是怎么来的吗？有没有抱怨过不知所谓还催的要死的需求，今天做了，明天再改回去？因为产品经理也有KpI,也要写周报，PPT，晋升等等。很多时候你已经忙的不可开交还要给他们跑数，接紧急需求。</p><p>为什么会有产品经理？注意，这是我国互联网独有的职位，很多海外回来的同行一开始都会被他们的工作性质所震惊。旧社会的监工又回来了。一群叉着腰反着白眼冲你咆哮“”产品经理不需要懂技术，需求你必须要实现”的人们，拿着比你还高的工资，提着他们自己都说不清楚的需求。这不是小公司独有的现象，我说的是BAT。</p><p>在海外互联网和传统软件行业，需求是项目经理与客户沟通后指制定的，然后由技术主管逐一拆解，分配到人。项目经理一般是有十年以上开发经验的资深人员担任，懂但是不插手具体技术实现，技术主管总揽全局，把控整个项目的技术选型，进度和难点攻坚。反观我国的互联网行业，技术主管多数做的是合并周报，向上管理的工作。其中很多人已经多年不写代码了，项目经理很多根本不是技术出身的。在全民拼绩效的环境下，一线开发人员的绩效由技术主管决定，与他关系的远近直接决定了绩效高低，能否晋升。不是主管嫡系的人技术再好，干的活再多也是被排挤的角色，完全没有努力工作的动力。而项目经理连低下技术人员的名字都认不出几个，更不可能提携。</p><p>是什么形成了这种畸形的管理机制？国内互联网一个项目组动辄几十人还算少的，顶着项目经理头衔的人根本不可能亲自管理，这才派生出产品经理这一四不像的职位。</p><p>产品经理的定义是管理产品而非人的经理，但绝大部分产品既不懂产品逻辑也不懂技术，只知道坚定不移地执行老板的想法，不是监工是什么呢？带来的结果就是程序员疲于应付各种奇葩需求，反复修改做无用功，也不利于技术的提高和积累。更加因为需求不明确不专业而把大量时间耗费在沟通上，沟通与开发时间竟高达8：2，很多人白天开会晚上加班写代码。更雪上加霜的是，程序员还要与运营，测试等对接，这些人同样不懂需求和功能的逻辑，随时都在提问题。</p><p>以上是绝大多数国内互联网公司工作的常态，还不算某些特别奇葩过分的行为。总的来说一句话，国内互联网打着高科技的旗号，做着劳动密集型的工作，实行高度官僚化的管理，这样怎么可能有希望呢？</p>Sun, 12 Jul 2020 04:30:08 GMT
https://www.zhihu.com/question/389889237/answer/1329721000
https://www.zhihu.com/question/389889237/answer/1329721000                                                talktomyself


赞同了回答: 感觉中国程序员前景一片灰暗，是这样吗？<p>嗯，是的。</p><p>但是并不是因为技术更新快，涌入人员多。</p><p>国外的软件行业这些问题都有，但是并没有内卷到这种程度。</p><p>如果说是因为国外人少，我承认，有这个原因，但绝不是全部。</p><p>我国互联网行业的管理其实是特别具有中国特色的，换句话说跟国际不接轨。越来越多海归的互联网从业人员可以证明的，早年建立当今这套管理体系的人，如果打着引进国外先进经验的旗号，那绝对是挂着羊头卖狗肉。</p><p>首先，全体KPI。国内的程序员羡慕国外的同行不用996，没有一个接一个的迭代，有时间学习新技术，work life balance. 你想过那源源不断的需求是怎么来的吗？有没有抱怨过不知所谓还催的要死的需求，今天做了，明天再改回去？因为产品经理也有KpI,也要写周报，PPT，晋升等等。很多时候你已经忙的不可开交还要给他们跑数，接紧急需求。</p><p>为什么会有产品经理？注意，这是我国互联网独有的职位，很多海外回来的同行一开始都会被他们的工作性质所震惊。旧社会的监工又回来了。一群叉着腰反着白眼冲你咆哮“”产品经理不需要懂技术，需求你必须要实现”的人们，拿着比你还高的工资，提着他们自己都说不清楚的需求。这不是小公司独有的现象，我说的是BAT。</p><p>在海外互联网和传统软件行业，需求是项目经理与客户沟通后指制定的，然后由技术主管逐一拆解，分配到人。项目经理一般是有十年以上开发经验的资深人员担任，懂但是不插手具体技术实现，技术主管总揽全局，把控整个项目的技术选型，进度和难点攻坚。反观我国的互联网行业，技术主管多数做的是合并周报，向上管理的工作。其中很多人已经多年不写代码了，项目经理很多根本不是技术出身的。在全民拼绩效的环境下，一线开发人员的绩效由技术主管决定，与他关系的远近直接决定了绩效高低，能否晋升。不是主管嫡系的人技术再好，干的活再多也是被排挤的角色，完全没有努力工作的动力。而项目经理连低下技术人员的名字都认不出几个，更不可能提携。</p><p>是什么形成了这种畸形的管理机制？国内互联网一个项目组动辄几十人还算少的，顶着项目经理头衔的人根本不可能亲自管理，这才派生出产品经理这一四不像的职位。</p><p>产品经理的定义是管理产品而非人的经理，但绝大部分产品既不懂产品逻辑也不懂技术，只知道坚定不移地执行老板的想法，不是监工是什么呢？带来的结果就是程序员疲于应付各种奇葩需求，反复修改做无用功，也不利于技术的提高和积累。更加因为需求不明确不专业而把大量时间耗费在沟通上，沟通与开发时间竟高达8：2，很多人白天开会晚上加班写代码。更雪上加霜的是，程序员还要与运营，测试等对接，这些人同样不懂需求和功能的逻辑，随时都在提问题。</p><p>以上是绝大多数国内互联网公司工作的常态，还不算某些特别奇葩过分的行为。总的来说一句话，国内互联网打着高科技的旗号，做着劳动密集型的工作，实行高度官僚化的管理，这样怎么可能有希望呢？</p>Sun, 12 Jul 2020 04:25:18 GMT
https://www.zhihu.com/question/389889237/answer/1329721000
https://www.zhihu.com/question/389889237/answer/1329721000                                                talktomyself


赞同了回答: 为什么感觉现在全中国都在加班，到底都在加什么？<p>我在上海，90年，年轻人和中年人的交接点的年龄，我很丧。</p><p>我每天五点五十起床，没有别的原因，因为上海限制外地牌照，七点前必须要下中环，不然就扣分了，只能六点就得出发，没办法 。我们是国五的车不能拍牌，车也没到要换车的时间。我每天七点多一点到公司，吃饭，然后开始抓紧时间工作，公司上班时间正常八点半到五点半，但是新公司是民企，公司有加班文化，很多人白天不干，晚上做样子加班，都不走，所以很多人会九点到公司，虽然我来的最早，但是没人关注，到六点半，我已经在公司快十二个小时了，精疲力尽，虽然很忙，但是也差不多完成了，然后，我就成了我们公司最早回家的人，我不想管，外企待久了特别讨厌形式主义，也懒得去看领导脸色，做完就走，但是久而久之大家都觉得你活少，多分点，永远很忙很忙的状态，但是我还是觉得满负荷十一个小时再多东西也基本做得完，做完就走没必要待这么晚，而别人要到七八点才走，所以我就看上去非常不努力，每天都提前跑，但是没办法，只能做到这样了，我老公每天接送我上下班，再去他公司，每天开车四个小时，你问他累么？每天回到家一动不动要躺十分钟才能打起精神去吃饭。你问我想要早起么？并不想。小区老破小没地方停车，只能停外面路边，直到今天早晨，小区发了一张通知，说我们停车的路边要安装防护栏，以后没地方停车了，估计要停到很远的地方走过去，不知道这样的日子什么时候是个头，也不知道，大家是不是都这么累，这是常态，还是说我太矫情了？为什么年轻人这么丧。因为太累，实在笑不起来。都说九九六是福报，很多人为的加班真的是浪费生命。但是社会就是这么病态氛围了，呵呵哒。说实话，除了降低效率，拉低消费，剥夺员工时间和幸福感，没有任何意义。华为996，是真的忙，我们公司的忙，真的是人为的。这是我的第一份民企公司，我不知道是不是具有个例性还是普遍如此，希望大部分的公司要比我好，大部分的人，比我幸福。</p><p>我的上一家公司。五点下班，班车五点十分开，四点五十大家就开始准备了，我从来没关注过领导啥时候走的，也没有一天哪怕一次担心会不会正常走不好，这是瑞典的公司，休假写我们财务部自己的黑板上就行，现在想想，真是太nice了。国内的公司，就是这种氛围，大的跨国企业几十年留下的好的基因，可能不看脸色舒心工作，就是最好之一。 </p><p>第一份工作500强美企，半小时就得申请加班，然后一个季度得调休完，不然就得给加班费，公司为了不给加班费，我确实有过七个小时被赶回家休假的经历，现在想来，那时还是挺幸福的。</p><p>下份工作我肯定跳槽还进外企了，但是不知道有生之年后浪的孩子们能不能让大部分的民企的工作环境也有所改善，这一代人，自主，自信，有能力让时间花在有意义的事情上面，希望应该大概率会有变革吧。</p>Sat, 11 Jul 2020 06:15:12 GMT
https://www.zhihu.com/question/284445841/answer/1252705660
https://www.zhihu.com/question/284445841/answer/1252705660                                                myday


赞同了文章: Elasticsearch 在各大互联网公司大量真实的应用案例！<p></p><p></p><p></p><ul><li>一、京东到家订单中心 Elasticsearch 演进历程</li><li>二、携程Elasticsearch应用案例</li><li>三、去哪儿：订单中心基于elasticsearch 的解决方案</li><li>四、Elasticsearch 在58集团信息安全部的应用</li><li>五、滴滴Elasticsearch多集群架构实践</li><li>六、Elasticsearch实用化订单搜索方</li></ul><hr><ul><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/zhishixingqiu/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《Java 2019 超神之路》</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/Dubbo/good-collection/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《Dubbo 实现原理与源码解析 —— 精品合集》</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/Spring/good-collection/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《Spring 实现原理与源码解析 —— 精品合集》</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/MyBatis/good-collection/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《MyBatis 实现原理与源码解析 —— 精品合集》</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/Spring-MVC/good-collection/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《Spring MVC 实现原理与源码解析 —— 精品合集》</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/Spring-Boot/good-collection/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《Spring Boot 实现原理与源码解析 —— 精品合集》</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/Entity/good-collection/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《数据库实体设计合集》</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/Interview/good-collection/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《Java 面试题 —— 精品合集》</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/Interview/good-collection/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《Java 学习指南 —— 精品合集》</a></li></ul><hr><p>国内现在有大量的公司都在使用 Elasticsearch，包括携程、滴滴、今日头条、饿了么、360安全、小米、vivo等诸多知名公司。</p><p>除了搜索之外，结合Kibana、Logstash、Beats，Elastic Stack还被广泛运用在大数据近实时分析领域，包括日志分析、指标监控、信息安全等多个领域。</p><p>它可以帮助你探索海量结构化、非结构化数据，按需创建可视化报表，对监控数据设置报警阈值，甚至通过使用机器学习技术，自动识别异常状况。</p><h2><b>一、京东到家订单中心 Elasticsearch 演进历程</b></h2><p>京东到家订单中心系统业务中，无论是外部商家的订单生产，或是内部上下游系统的依赖，订单查询的调用量都非常大，造成了订单数据读多写少的情况。</p><p>京东到家的订单数据存储在MySQL中，但显然只通过DB来支撑大量的查询是不可取的，同时对于一些复杂的查询，Mysql支持得不够友好，所以订单中心系统使用了Elasticsearch来承载订单查询的主要压力。</p><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-0beae65e7c4bf442ea850891a96a206d_r.jpg" data-caption data-size="normal" data-rawwidth="686" data-rawheight="381" class="origin_image zh-lightbox-thumb lazy" data-original="https://pic4.zhimg.com/v2-0beae65e7c4bf442ea850891a96a206d_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-0beae65e7c4bf442ea850891a96a206d_b.jpg" referrerpolicy="no-referrer"></figure><p>Elasticsearch 做为一款功能强大的分布式搜索引擎，支持近实时的存储、搜索数据，在京东到家订单系统中发挥着巨大作用，目前订单中心ES集群存储数据量达到10亿个文档，日均查询量达到5亿。</p><p>随着京东到家近几年业务的快速发展，订单中心ES架设方案也不断演进，发展至今ES集群架设是一套实时互备方案，很好的保障了ES集群读写的稳定性。</p><figure data-size="normal"><img src="https://pic3.zhimg.com/v2-4a8091fb7fe69fa477a4f2ecb0c8b621_r.jpg" data-caption data-size="normal" data-rawwidth="486" data-rawheight="350" class="origin_image zh-lightbox-thumb lazy" data-original="https://pic3.zhimg.com/v2-4a8091fb7fe69fa477a4f2ecb0c8b621_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-4a8091fb7fe69fa477a4f2ecb0c8b621_b.jpg" referrerpolicy="no-referrer"></figure><p>如上图，订单中心ES集群架设示意图。整个架设方式通过VIP来负载均衡外部请求，第一层gateway节点实质为ES中client node，相当于一个智能负载均衡器，充当着分发请求的角色。</p><p>第二层为data node，负责存储数据以及执行数据的相关操作。整个集群有一套主分片，二套副分片（一主二副），从网关节点转发过来的请求，会在打到数据节点之前通过轮询的方式进行均衡。集群增加一套副本并扩容机器的方式，增加了集群吞吐量，从而提升了整个集群查询性能。</p><p>当然分片数量和分片副本数量并不是越多越好，在此阶段中，对选择适当的分片数量做了近一步探索。</p><p>分片数可以理解为Mysql中的分库分表，而当前订单中心ES查询主要分为两类：单ID查询以及分页查询。</p><p>分片数越大，集群横向扩容规模也更大，根据分片路由的单ID查询吞吐量也能大大提升，但对于聚合的分页查询性能则将降低。分片数越小，集群横向扩容规模更小，单ID的查询性能也将下降，但对于分页查询，性能将会得到提升。</p><p>所以如何均衡分片数量和现有查询业务，我们做了很多次调整压测，最终选择了集群性能较好的分片数。</p><p>由于大部分ES查询的流量都来源于近几天的订单，且订单中心数据库数据已有一套归档机制，将指定天数之前已经关闭的订单转移到历史订单库。</p><p>架构的快速迭代源于业务的快速发展，正是由于近几年到家业务的高速发展，订单中心的架构也不断优化升级。</p><p><b>架构方案没有最好的，只有最合适的。相信再过几年，订单中心的架构又将是另一个面貌，但吞吐量更大，性能更好，稳定性更强，将是订单中心系统永远的追求。</b></p><h2><b>二、携程Elasticsearch应用案例</b></h2><h3><b>1. 携程酒店订单Elasticsearch实战</b></h3><p>选择对分片后的数据库建立实时索引，把查询收口到一个独立的 Web Service，在保证性能的前提下，提升业务应用查询时的便捷性。</p><p>最终我们选择了 Elasticsearch，看中的是它的轻量级、易用和对分布式更好的支持，整个安装包也只有几十兆。</p><p><a href="http://link.zhihu.com/?target=http%3A//developer.51cto.com/art/201807/579354.htm" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">developer.51cto.com/art</span><span class="invisible">/201807/579354.htm</span><span class="ellipsis"></span></a></p><h3><b>2. 携程机票ElasticSearch集群运维驯服记</b></h3><figure data-size="normal"><img src="https://pic1.zhimg.com/v2-dae54d15fb77fa668d693c72fd582fdb_r.jpg" data-caption data-size="normal" data-rawwidth="848" data-rawheight="407" class="origin_image zh-lightbox-thumb lazy" data-original="https://pic1.zhimg.com/v2-dae54d15fb77fa668d693c72fd582fdb_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-dae54d15fb77fa668d693c72fd582fdb_b.jpg" referrerpolicy="no-referrer"></figure><p>这个是比较通用的数据的流程，一般会通过Kafka分离产生数据的应用程序和后面的平台，通过ETL落到不同的地方，按照优先级和冷热程度采取不同的存储方式。</p><p>一般来说，冷数据存放到HDFS，如果温数据、或者热数据会采用Database以及Cache。一旦数据落地，我们会做两方面的应用</p><p>第一个方面的应用是传统BI，比如会产生各种各样的报表，报表的受众是更高的决策层和管理层，他们看了之后，会有相应的业务调整和更高层面的规划或转变。</p><p>这个使用路径比较传统的，在数据仓库时代就已经存在了。现在有一种新兴的场景就是利用大数据进行快速决策，数据不是喂给人的，数据分析结果由程序来消费，其实是再次的反馈到数据源头即应用程序中，让他们基于快速分析后的结果，调整已有策略，这样就形成了一个数据使用的循环。</p><p>这样我们从它的输入到输出会形成一种闭环，而且这个闭环全部是机器参与的，这也是为什么去研究这种大规模的，或者快速决策的原因所在。</p><p>如果数据最终还会给人本身来看的话，就没有必要更新那么快，因为一秒钟刷新一次或者10秒钟刷新一次对人是没有意义的，因为我们脑子不可能一直转那么快，基于数据一直的做调整也是不现实的，但是对机器来讲，就完全没有问题。</p><p><a href="http://link.zhihu.com/?target=http%3A//www.sohu.com/a/199672012_411876" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://www.</span><span class="visible">sohu.com/a/199672012_41</span><span class="invisible">1876</span><span class="ellipsis"></span></a></p><h3><b>3. 携程：大规模 Elasticsearch 集群管理心得</b></h3><p>目前，我们最大的日志单集群有120个data node，运行于70台物理服务器上。数据规模如下:</p><ul><li>单日索引数据条数600亿，新增索引文件25TB (含一个复制片则为50TB)</li><li>业务高峰期峰值索引速率维持在百万条/秒</li><li>历史数据保留时长根据业务需求制定，从10天 - 90天不等</li><li>集群共3441个索引、17000个分片、数据总量约9300亿, 磁盘总消耗1PB</li></ul><p><a href="http://link.zhihu.com/?target=https%3A//www.jianshu.com/p/6470754b8248" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">
https://www.</span><span class="visible">jianshu.com/p/6470754b8</span><span class="invisible">248</span><span class="ellipsis"></span></a></p><h2><b>三、去哪儿：订单中心基于elasticsearch 的解决方案</b></h2><p>15年去哪儿网酒店日均订单量达到30w+，随着多平台订单的聚合日均订单能达到100w左右。</p><p>原来采用的热表分库方式，即将最近6个月的订单的放置在一张表中，将历史订单放在在history表中。history表存储全量的数据，当用户查询的下单时间跨度超过6个月即查询历史订单表，此分表方式热表的数据量为4000w左右，当时能解决的问题。但是显然不能满足携程艺龙订单接入的需求。</p><p>如果继续按照热表方式，数据量将超过1亿条。全量数据表保存2年的可能就超过4亿的数据量。所以寻找有效途径解决此问题迫在眉睫。</p><p>由于对这预计4亿的数据量还需按照预定日期、入住日期、离店日期、订单号、联系人姓名、电话、酒店名称、订单状态……等多个条件查询。所以简单按照某一个维度进行分表操作没有意义。</p><p>Elasticsearch分布式搜索储存集群的引入，就是为了解决订单数据的存储与搜索的问题。</p><p>对订单模型进行抽象和分类，将常用搜索字段和基础属性字段剥离。DB做分库分表，存储订单详情；Elasticsearch存储搜素字段。</p><p>订单复杂查询直接走Elasticsearch，基于OrderNo的简单查询走DB，如下图所示。</p><figure data-size="normal"><img src="https://pic1.zhimg.com/v2-b62618512759d5df680bdd642b9bd079_r.jpg" data-caption data-size="normal" data-rawwidth="853" data-rawheight="470" class="origin_image zh-lightbox-thumb lazy" data-original="https://pic1.zhimg.com/v2-b62618512759d5df680bdd642b9bd079_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-b62618512759d5df680bdd642b9bd079_b.jpg" referrerpolicy="no-referrer"></figure><p>系统伸缩性：Elasticsearch 中索引设置了8个分片，目前ES单个索引的文档达到1.4亿，合计达到2亿条数据占磁盘大小64G，集群机器磁盘容量240G。</p><p><a href="http://link.zhihu.com/?target=https%3A//elasticsearch.cn/article/6197" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">
https://</span><span class="visible">elasticsearch.cn/articl</span><span class="invisible">e/6197</span><span class="ellipsis"></span></a></p><h2><b>四、Elasticsearch 在58集团信息安全部的应用</b></h2><p>全面介绍 Elastic Stack 在58集团信息安全部的落地，升级，优化以及应用。</p><p>包括如下几个方面：接入背景，存储选型，性能挑战，master node以及data node优化，安全实践，高吞吐量以及低延迟搜索优化；kibana 的落地，本地化使其更方便产品、运营使用。</p><figure data-size="normal"><img src="https://pic1.zhimg.com/v2-c788effb6044094095dd7d8eeb720356_r.jpg" data-caption data-size="normal" data-rawwidth="556" data-rawheight="354" class="origin_image zh-lightbox-thumb lazy" data-original="https://pic1.zhimg.com/v2-c788effb6044094095dd7d8eeb720356_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-c788effb6044094095dd7d8eeb720356_b.jpg" referrerpolicy="no-referrer"></figure><p><a href="http://link.zhihu.com/?target=https%3A//elasticsearch.cn/slides/124" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">
https://</span><span class="visible">elasticsearch.cn/slides</span><span class="invisible">/124</span><span class="ellipsis"></span></a></p><h2><b>五、滴滴Elasticsearch多集群架构实践</b></h2><p>滴滴 2016 年初开始构建 Elasticsearch 平台，如今已经发展到超过 3500+ Elasticsearch 实例，超过 5PB 的数据存储，峰值写入 tps 超过了 2000w/s 的超大规模。</p><p>Elasticsearch 在滴滴有着非常丰富的使用场景，例如线上核心的打车地图搜索，客服、运营的多维度查询，滴滴日志服务等近千个平台用户。</p><p>先看看滴滴 Elasticsearch 单集群的架构：滴滴在单集群架构的时候，写入和查询就已经通过 Sink 服务和 Gateway 服务管控起来。</p><figure data-size="normal"><img src="https://pic1.zhimg.com/v2-9918e88bcfbe7a01da3be7bf3a53afe3_r.jpg" data-caption data-size="normal" data-rawwidth="989" data-rawheight="317" class="origin_image zh-lightbox-thumb lazy" data-original="https://pic1.zhimg.com/v2-9918e88bcfbe7a01da3be7bf3a53afe3_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-9918e88bcfbe7a01da3be7bf3a53afe3_b.jpg" referrerpolicy="no-referrer"></figure><h3><b>1. Sink服务</b></h3><p>滴滴几乎所有写入 Elasticsearch 的数据都是经由 kafka 消费入到 Elasticsearch。kafka 的数据包括业务 log 数据、mysql binlog 数据和业务自主上报的数据，Sink 服务将这些数据实时消费入到 Elasticsearch。</p><p>最初设计 Sink 服务是想对写入 Elasticsearch 集群进行管控，保护 Elasticsearch 集群，防止海量的数据写入拖垮 Elasticsearch，之后我们也一直沿用了 Sink 服务，并将该服务从 Elasticsearch 平台分离出去，成立滴滴 Sink 数据投递平台，可以从 kafka 或者 MQ 实时同步数据到 Elasticsearch、HDFS、Ceph 等多个存储服务。</p><p>有了多集群架构后，Elasticsearch 平台可以消费一份 MQ 数据写入多个 Elasticsearch 集群，做到集群级别的容灾，还能通过 MQ 回溯数据进行故障恢复。</p><h3><b>2. Gateway 服务</b></h3><p>所有业务的查询都是经过 Gateway 服务，Gateway 服务实现了 Elasticsearch 的 http restful 和 tcp 协议，业务方可以通过 Elasticsearch 各语言版本的 sdk 直接访问 Gateway 服务</p><p>Gateway 服务还实现了 SQL 接口，业务方可以直接使用 SQL 访问 Elasticsearch 平台。</p><p>Gateway 服务最初提供了应用权限的管控，访问记录，限流、降级等基本能力，后面随着平台演进，Gateway 服务还提供了索引存储分离、DSL 级别的限流、多集群灾备等能力。</p><h2><b>六、Elasticsearch实用化订单搜索方案</b></h2><p>搜索引擎中，主要考虑到Elasticsearch支持结构化数据查询以及支持实时频繁更新特性，传统订单查询报表的痛点，以及Elasticsearch能够帮助解决的问题。</p><figure data-size="normal"><img src="https://pic3.zhimg.com/v2-29c1e66f82a753cb5b2d26d543f01f2c_r.jpg" data-caption data-size="normal" data-rawwidth="667" data-rawheight="477" class="origin_image zh-lightbox-thumb lazy" data-original="https://pic3.zhimg.com/v2-29c1e66f82a753cb5b2d26d543f01f2c_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-29c1e66f82a753cb5b2d26d543f01f2c_b.jpg" referrerpolicy="no-referrer"></figure><h3><b>订单搜索系统架构</b></h3><p>整个业务线使用服务化方式，Elasticsearch集群和数据库分库，作为数据源被订单服务系统封装为对外统一接口；各前、后台应用和报表中心，使用服务化的方式获取订单数据。</p><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-18a652cb6f5aa619ba6fbee28b441111_r.jpg" data-caption data-size="normal" data-rawwidth="898" data-rawheight="570" class="origin_image zh-lightbox-thumb lazy" data-original="https://pic4.zhimg.com/v2-18a652cb6f5aa619ba6fbee28b441111_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-18a652cb6f5aa619ba6fbee28b441111_b.jpg" referrerpolicy="no-referrer"></figure><p><a href="http://link.zhihu.com/?target=https%3A//my.oschina.net/u/2485991/blog/533163" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">
https://</span><span class="visible">my.oschina.net/u/248599</span><span class="invisible">1/blog/533163</span><span class="ellipsis"></span></a></p><p>来源：Rickie</p><p><a href="http://link.zhihu.com/?target=http%3A//cnblogs.com/rickie/p/11648622.html" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">cnblogs.com/rickie/p/11</span><span class="invisible">648622.html</span><span class="ellipsis"></span></a><br></p><ul><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/zhishixingqiu/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《Java 2019 超神之路》</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/Dubbo/good-collection/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《Dubbo 实现原理与源码解析 —— 精品合集》</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/Spring/good-collection/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《Spring 实现原理与源码解析 —— 精品合集》</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/MyBatis/good-collection/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《MyBatis 实现原理与源码解析 —— 精品合集》</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/Spring-MVC/good-collection/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《Spring MVC 实现原理与源码解析 —— 精品合集》</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/Spring-Boot/good-collection/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《Spring Boot 实现原理与源码解析 —— 精品合集》</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/Entity/good-collection/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《数据库实体设计合集》</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/Interview/good-collection/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《Java 面试题 —— 精品合集》</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/Interview/good-collection/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《Java 学习指南 —— 精品合集》</a></li></ul><p></p><p></p>Sat, 11 Jul 2020 06:05:14 GMT
https://zhuanlan.zhihu.com/p/138888359
https://zhuanlan.zhihu.com/p/138888359                                                芋道源码


收藏了文章: Elasticsearch 在各大互联网公司大量真实的应用案例！<p></p><p></p><p></p><ul><li>一、京东到家订单中心 Elasticsearch 演进历程</li><li>二、携程Elasticsearch应用案例</li><li>三、去哪儿：订单中心基于elasticsearch 的解决方案</li><li>四、Elasticsearch 在58集团信息安全部的应用</li><li>五、滴滴Elasticsearch多集群架构实践</li><li>六、Elasticsearch实用化订单搜索方</li></ul><hr><ul><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/zhishixingqiu/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《Java 2019 超神之路》</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/Dubbo/good-collection/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《Dubbo 实现原理与源码解析 —— 精品合集》</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/Spring/good-collection/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《Spring 实现原理与源码解析 —— 精品合集》</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/MyBatis/good-collection/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《MyBatis 实现原理与源码解析 —— 精品合集》</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/Spring-MVC/good-collection/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《Spring MVC 实现原理与源码解析 —— 精品合集》</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/Spring-Boot/good-collection/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《Spring Boot 实现原理与源码解析 —— 精品合集》</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/Entity/good-collection/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《数据库实体设计合集》</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/Interview/good-collection/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《Java 面试题 —— 精品合集》</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/Interview/good-collection/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《Java 学习指南 —— 精品合集》</a></li></ul><hr><p>国内现在有大量的公司都在使用 Elasticsearch，包括携程、滴滴、今日头条、饿了么、360安全、小米、vivo等诸多知名公司。</p><p>除了搜索之外，结合Kibana、Logstash、Beats，Elastic Stack还被广泛运用在大数据近实时分析领域，包括日志分析、指标监控、信息安全等多个领域。</p><p>它可以帮助你探索海量结构化、非结构化数据，按需创建可视化报表，对监控数据设置报警阈值，甚至通过使用机器学习技术，自动识别异常状况。</p><h2><b>一、京东到家订单中心 Elasticsearch 演进历程</b></h2><p>京东到家订单中心系统业务中，无论是外部商家的订单生产，或是内部上下游系统的依赖，订单查询的调用量都非常大，造成了订单数据读多写少的情况。</p><p>京东到家的订单数据存储在MySQL中，但显然只通过DB来支撑大量的查询是不可取的，同时对于一些复杂的查询，Mysql支持得不够友好，所以订单中心系统使用了Elasticsearch来承载订单查询的主要压力。</p><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-0beae65e7c4bf442ea850891a96a206d_r.jpg" data-caption data-size="normal" data-rawwidth="686" data-rawheight="381" class="origin_image zh-lightbox-thumb lazy" data-original="https://pic4.zhimg.com/v2-0beae65e7c4bf442ea850891a96a206d_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-0beae65e7c4bf442ea850891a96a206d_b.jpg" referrerpolicy="no-referrer"></figure><p>Elasticsearch 做为一款功能强大的分布式搜索引擎，支持近实时的存储、搜索数据，在京东到家订单系统中发挥着巨大作用，目前订单中心ES集群存储数据量达到10亿个文档，日均查询量达到5亿。</p><p>随着京东到家近几年业务的快速发展，订单中心ES架设方案也不断演进，发展至今ES集群架设是一套实时互备方案，很好的保障了ES集群读写的稳定性。</p><figure data-size="normal"><img src="https://pic3.zhimg.com/v2-4a8091fb7fe69fa477a4f2ecb0c8b621_r.jpg" data-caption data-size="normal" data-rawwidth="486" data-rawheight="350" class="origin_image zh-lightbox-thumb lazy" data-original="https://pic3.zhimg.com/v2-4a8091fb7fe69fa477a4f2ecb0c8b621_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-4a8091fb7fe69fa477a4f2ecb0c8b621_b.jpg" referrerpolicy="no-referrer"></figure><p>如上图，订单中心ES集群架设示意图。整个架设方式通过VIP来负载均衡外部请求，第一层gateway节点实质为ES中client node，相当于一个智能负载均衡器，充当着分发请求的角色。</p><p>第二层为data node，负责存储数据以及执行数据的相关操作。整个集群有一套主分片，二套副分片（一主二副），从网关节点转发过来的请求，会在打到数据节点之前通过轮询的方式进行均衡。集群增加一套副本并扩容机器的方式，增加了集群吞吐量，从而提升了整个集群查询性能。</p><p>当然分片数量和分片副本数量并不是越多越好，在此阶段中，对选择适当的分片数量做了近一步探索。</p><p>分片数可以理解为Mysql中的分库分表，而当前订单中心ES查询主要分为两类：单ID查询以及分页查询。</p><p>分片数越大，集群横向扩容规模也更大，根据分片路由的单ID查询吞吐量也能大大提升，但对于聚合的分页查询性能则将降低。分片数越小，集群横向扩容规模更小，单ID的查询性能也将下降，但对于分页查询，性能将会得到提升。</p><p>所以如何均衡分片数量和现有查询业务，我们做了很多次调整压测，最终选择了集群性能较好的分片数。</p><p>由于大部分ES查询的流量都来源于近几天的订单，且订单中心数据库数据已有一套归档机制，将指定天数之前已经关闭的订单转移到历史订单库。</p><p>架构的快速迭代源于业务的快速发展，正是由于近几年到家业务的高速发展，订单中心的架构也不断优化升级。</p><p><b>架构方案没有最好的，只有最合适的。相信再过几年，订单中心的架构又将是另一个面貌，但吞吐量更大，性能更好，稳定性更强，将是订单中心系统永远的追求。</b></p><h2><b>二、携程Elasticsearch应用案例</b></h2><h3><b>1. 携程酒店订单Elasticsearch实战</b></h3><p>选择对分片后的数据库建立实时索引，把查询收口到一个独立的 Web Service，在保证性能的前提下，提升业务应用查询时的便捷性。</p><p>最终我们选择了 Elasticsearch，看中的是它的轻量级、易用和对分布式更好的支持，整个安装包也只有几十兆。</p><p><a href="http://link.zhihu.com/?target=http%3A//developer.51cto.com/art/201807/579354.htm" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">developer.51cto.com/art</span><span class="invisible">/201807/579354.htm</span><span class="ellipsis"></span></a></p><h3><b>2. 携程机票ElasticSearch集群运维驯服记</b></h3><figure data-size="normal"><img src="https://pic1.zhimg.com/v2-dae54d15fb77fa668d693c72fd582fdb_r.jpg" data-caption data-size="normal" data-rawwidth="848" data-rawheight="407" class="origin_image zh-lightbox-thumb lazy" data-original="https://pic1.zhimg.com/v2-dae54d15fb77fa668d693c72fd582fdb_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-dae54d15fb77fa668d693c72fd582fdb_b.jpg" referrerpolicy="no-referrer"></figure><p>这个是比较通用的数据的流程，一般会通过Kafka分离产生数据的应用程序和后面的平台，通过ETL落到不同的地方，按照优先级和冷热程度采取不同的存储方式。</p><p>一般来说，冷数据存放到HDFS，如果温数据、或者热数据会采用Database以及Cache。一旦数据落地，我们会做两方面的应用</p><p>第一个方面的应用是传统BI，比如会产生各种各样的报表，报表的受众是更高的决策层和管理层，他们看了之后，会有相应的业务调整和更高层面的规划或转变。</p><p>这个使用路径比较传统的，在数据仓库时代就已经存在了。现在有一种新兴的场景就是利用大数据进行快速决策，数据不是喂给人的，数据分析结果由程序来消费，其实是再次的反馈到数据源头即应用程序中，让他们基于快速分析后的结果，调整已有策略，这样就形成了一个数据使用的循环。</p><p>这样我们从它的输入到输出会形成一种闭环，而且这个闭环全部是机器参与的，这也是为什么去研究这种大规模的，或者快速决策的原因所在。</p><p>如果数据最终还会给人本身来看的话，就没有必要更新那么快，因为一秒钟刷新一次或者10秒钟刷新一次对人是没有意义的，因为我们脑子不可能一直转那么快，基于数据一直的做调整也是不现实的，但是对机器来讲，就完全没有问题。</p><p><a href="http://link.zhihu.com/?target=http%3A//www.sohu.com/a/199672012_411876" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://www.</span><span class="visible">sohu.com/a/199672012_41</span><span class="invisible">1876</span><span class="ellipsis"></span></a></p><h3><b>3. 携程：大规模 Elasticsearch 集群管理心得</b></h3><p>目前，我们最大的日志单集群有120个data node，运行于70台物理服务器上。数据规模如下:</p><ul><li>单日索引数据条数600亿，新增索引文件25TB (含一个复制片则为50TB)</li><li>业务高峰期峰值索引速率维持在百万条/秒</li><li>历史数据保留时长根据业务需求制定，从10天 - 90天不等</li><li>集群共3441个索引、17000个分片、数据总量约9300亿, 磁盘总消耗1PB</li></ul><p><a href="http://link.zhihu.com/?target=https%3A//www.jianshu.com/p/6470754b8248" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">
https://www.</span><span class="visible">jianshu.com/p/6470754b8</span><span class="invisible">248</span><span class="ellipsis"></span></a></p><h2><b>三、去哪儿：订单中心基于elasticsearch 的解决方案</b></h2><p>15年去哪儿网酒店日均订单量达到30w+，随着多平台订单的聚合日均订单能达到100w左右。</p><p>原来采用的热表分库方式，即将最近6个月的订单的放置在一张表中，将历史订单放在在history表中。history表存储全量的数据，当用户查询的下单时间跨度超过6个月即查询历史订单表，此分表方式热表的数据量为4000w左右，当时能解决的问题。但是显然不能满足携程艺龙订单接入的需求。</p><p>如果继续按照热表方式，数据量将超过1亿条。全量数据表保存2年的可能就超过4亿的数据量。所以寻找有效途径解决此问题迫在眉睫。</p><p>由于对这预计4亿的数据量还需按照预定日期、入住日期、离店日期、订单号、联系人姓名、电话、酒店名称、订单状态……等多个条件查询。所以简单按照某一个维度进行分表操作没有意义。</p><p>Elasticsearch分布式搜索储存集群的引入，就是为了解决订单数据的存储与搜索的问题。</p><p>对订单模型进行抽象和分类，将常用搜索字段和基础属性字段剥离。DB做分库分表，存储订单详情；Elasticsearch存储搜素字段。</p><p>订单复杂查询直接走Elasticsearch，基于OrderNo的简单查询走DB，如下图所示。</p><figure data-size="normal"><img src="https://pic1.zhimg.com/v2-b62618512759d5df680bdd642b9bd079_r.jpg" data-caption data-size="normal" data-rawwidth="853" data-rawheight="470" class="origin_image zh-lightbox-thumb lazy" data-original="https://pic1.zhimg.com/v2-b62618512759d5df680bdd642b9bd079_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-b62618512759d5df680bdd642b9bd079_b.jpg" referrerpolicy="no-referrer"></figure><p>系统伸缩性：Elasticsearch 中索引设置了8个分片，目前ES单个索引的文档达到1.4亿，合计达到2亿条数据占磁盘大小64G，集群机器磁盘容量240G。</p><p><a href="http://link.zhihu.com/?target=https%3A//elasticsearch.cn/article/6197" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">
https://</span><span class="visible">elasticsearch.cn/articl</span><span class="invisible">e/6197</span><span class="ellipsis"></span></a></p><h2><b>四、Elasticsearch 在58集团信息安全部的应用</b></h2><p>全面介绍 Elastic Stack 在58集团信息安全部的落地，升级，优化以及应用。</p><p>包括如下几个方面：接入背景，存储选型，性能挑战，master node以及data node优化，安全实践，高吞吐量以及低延迟搜索优化；kibana 的落地，本地化使其更方便产品、运营使用。</p><figure data-size="normal"><img src="https://pic1.zhimg.com/v2-c788effb6044094095dd7d8eeb720356_r.jpg" data-caption data-size="normal" data-rawwidth="556" data-rawheight="354" class="origin_image zh-lightbox-thumb lazy" data-original="https://pic1.zhimg.com/v2-c788effb6044094095dd7d8eeb720356_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-c788effb6044094095dd7d8eeb720356_b.jpg" referrerpolicy="no-referrer"></figure><p><a href="http://link.zhihu.com/?target=https%3A//elasticsearch.cn/slides/124" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">
https://</span><span class="visible">elasticsearch.cn/slides</span><span class="invisible">/124</span><span class="ellipsis"></span></a></p><h2><b>五、滴滴Elasticsearch多集群架构实践</b></h2><p>滴滴 2016 年初开始构建 Elasticsearch 平台，如今已经发展到超过 3500+ Elasticsearch 实例，超过 5PB 的数据存储，峰值写入 tps 超过了 2000w/s 的超大规模。</p><p>Elasticsearch 在滴滴有着非常丰富的使用场景，例如线上核心的打车地图搜索，客服、运营的多维度查询，滴滴日志服务等近千个平台用户。</p><p>先看看滴滴 Elasticsearch 单集群的架构：滴滴在单集群架构的时候，写入和查询就已经通过 Sink 服务和 Gateway 服务管控起来。</p><figure data-size="normal"><img src="https://pic1.zhimg.com/v2-9918e88bcfbe7a01da3be7bf3a53afe3_r.jpg" data-caption data-size="normal" data-rawwidth="989" data-rawheight="317" class="origin_image zh-lightbox-thumb lazy" data-original="https://pic1.zhimg.com/v2-9918e88bcfbe7a01da3be7bf3a53afe3_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-9918e88bcfbe7a01da3be7bf3a53afe3_b.jpg" referrerpolicy="no-referrer"></figure><h3><b>1. Sink服务</b></h3><p>滴滴几乎所有写入 Elasticsearch 的数据都是经由 kafka 消费入到 Elasticsearch。kafka 的数据包括业务 log 数据、mysql binlog 数据和业务自主上报的数据，Sink 服务将这些数据实时消费入到 Elasticsearch。</p><p>最初设计 Sink 服务是想对写入 Elasticsearch 集群进行管控，保护 Elasticsearch 集群，防止海量的数据写入拖垮 Elasticsearch，之后我们也一直沿用了 Sink 服务，并将该服务从 Elasticsearch 平台分离出去，成立滴滴 Sink 数据投递平台，可以从 kafka 或者 MQ 实时同步数据到 Elasticsearch、HDFS、Ceph 等多个存储服务。</p><p>有了多集群架构后，Elasticsearch 平台可以消费一份 MQ 数据写入多个 Elasticsearch 集群，做到集群级别的容灾，还能通过 MQ 回溯数据进行故障恢复。</p><h3><b>2. Gateway 服务</b></h3><p>所有业务的查询都是经过 Gateway 服务，Gateway 服务实现了 Elasticsearch 的 http restful 和 tcp 协议，业务方可以通过 Elasticsearch 各语言版本的 sdk 直接访问 Gateway 服务</p><p>Gateway 服务还实现了 SQL 接口，业务方可以直接使用 SQL 访问 Elasticsearch 平台。</p><p>Gateway 服务最初提供了应用权限的管控，访问记录，限流、降级等基本能力，后面随着平台演进，Gateway 服务还提供了索引存储分离、DSL 级别的限流、多集群灾备等能力。</p><h2><b>六、Elasticsearch实用化订单搜索方案</b></h2><p>搜索引擎中，主要考虑到Elasticsearch支持结构化数据查询以及支持实时频繁更新特性，传统订单查询报表的痛点，以及Elasticsearch能够帮助解决的问题。</p><figure data-size="normal"><img src="https://pic3.zhimg.com/v2-29c1e66f82a753cb5b2d26d543f01f2c_r.jpg" data-caption data-size="normal" data-rawwidth="667" data-rawheight="477" class="origin_image zh-lightbox-thumb lazy" data-original="https://pic3.zhimg.com/v2-29c1e66f82a753cb5b2d26d543f01f2c_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-29c1e66f82a753cb5b2d26d543f01f2c_b.jpg" referrerpolicy="no-referrer"></figure><h3><b>订单搜索系统架构</b></h3><p>整个业务线使用服务化方式，Elasticsearch集群和数据库分库，作为数据源被订单服务系统封装为对外统一接口；各前、后台应用和报表中心，使用服务化的方式获取订单数据。</p><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-18a652cb6f5aa619ba6fbee28b441111_r.jpg" data-caption data-size="normal" data-rawwidth="898" data-rawheight="570" class="origin_image zh-lightbox-thumb lazy" data-original="https://pic4.zhimg.com/v2-18a652cb6f5aa619ba6fbee28b441111_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-18a652cb6f5aa619ba6fbee28b441111_b.jpg" referrerpolicy="no-referrer"></figure><p><a href="http://link.zhihu.com/?target=https%3A//my.oschina.net/u/2485991/blog/533163" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">
https://</span><span class="visible">my.oschina.net/u/248599</span><span class="invisible">1/blog/533163</span><span class="ellipsis"></span></a></p><p>来源：Rickie</p><p><a href="http://link.zhihu.com/?target=http%3A//cnblogs.com/rickie/p/11648622.html" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">cnblogs.com/rickie/p/11</span><span class="invisible">648622.html</span><span class="ellipsis"></span></a><br></p><ul><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/zhishixingqiu/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《Java 2019 超神之路》</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/Dubbo/good-collection/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《Dubbo 实现原理与源码解析 —— 精品合集》</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/Spring/good-collection/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《Spring 实现原理与源码解析 —— 精品合集》</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/MyBatis/good-collection/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《MyBatis 实现原理与源码解析 —— 精品合集》</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/Spring-MVC/good-collection/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《Spring MVC 实现原理与源码解析 —— 精品合集》</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/Spring-Boot/good-collection/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《Spring Boot 实现原理与源码解析 —— 精品合集》</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/Entity/good-collection/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《数据库实体设计合集》</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/Interview/good-collection/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《Java 面试题 —— 精品合集》</a></li><li><a href="http://link.zhihu.com/?target=http%3A//www.iocoder.cn/Interview/good-collection/%3Fzhihu" class=" wrap external" target="_blank" rel="nofollow noreferrer">《Java 学习指南 —— 精品合集》</a></li></ul><p></p><p></p>Sat, 11 Jul 2020 06:05:13 GMT
https://zhuanlan.zhihu.com/p/138888359
https://zhuanlan.zhihu.com/p/138888359                                                芋道源码


回答了问题: 为什么做 Java 开发的公司需要那么多程序员？<p>本来没想太认真回答这个问题，但是经过不断补充完善，现在已经超一万两千字了。有些描述不当的地方，还有拼音输入引起的错字，都请及时指正。有些文字可能比较偏激和悲观，但我的本意是希望能够唤醒那些做企业应用的公司和里面的Java程序员。</p><p>作为一个41岁的老码农，确实需要给刚入行的新人或者正在项目组迷茫的程序员交代点什么了。</p><p>本文的主要内容：</p><p>领导层的梦想，以及九大特点。</p><p>程序员的梦想，以及三大谎言。</p><p>三个不愿分离，三个不愿统一。</p><p>正是上面这些原因造成公司觉得程序员永远不够用。</p><p><b>科学技术是第一生产力，人不是！如果非要说人也是，那么只有掌握科学技术的人才是。</b></p><p><b>科学技术是第一生产力，管理不是！如果非要说管理也是，那么只有适应当前技术并能解放生产力的管理制度才是。</b></p><p>如果想学习Spring Boot和Typescript/Angular/React，可以加我微信:<b>32698325。</b></p><p>最近搜我号的人太多，评论区有人反映搜索异常了。也可以先关注我的公众号：全栈通途</p><p>--------------------下面是回答--------------</p><p>透过现象看本质。</p><p>Java是企业应用市场的王者，如果一家非互联网公司用Java，那么十有八九是做企业应用的。</p><p>所以，这个问题本质上是：为什么做企业应用的公司需要那么多Java程序员。</p><p>开发企业应用的公司和程序员都有其自身的特点，我们分别展开说一下。</p><h2>我们先说说做企业应用的公司</h2><p>下面9点不一定在所有公司身上都存在，但肯定是大同小异。</p><ol><li>相对于互联网来说，企业应用不是一个公平竞争的市场。互联网公司创业之初往往是因为有好想法好技术，企业应用公司创业之初是因为老板有人脉有关系。大部分做企业应用的公司都是靠老板的人脉关系活着，靠在某个领域的关系垄断霸占着这块业务。而且也因为老板和高层习惯于人脉和关系，公司也会形成官僚国企文化，而不是工程师文化。所以这些公司技术老旧薄弱，技术人员也从来不会被重视。很多公司虽然有个高新技术认证，但根本没有任何技术含量可言。</li><li>客户是甲方是老板的上帝，老板得罪不起，因为得罪了就自毁人脉和关系，就没有在这个行业立足之本。特别是行业圈子有限，客户之间都是有联系的，得罪一个就会传到别人拿去。所以甲方可以蛮横的在需求、设计、技术方案等各种环节上提出自己的修改要求。而绝大多数甲方都是自以为是，什么都不懂，仅仅是为了表明自己懂或向领导证明自己懂。在项目实施过程中，和客户对接的程序员完全处于弱势。心中几万匹草泥马奔腾着，却要点头称是，敢怒不敢言。</li><li>有些甲方其实根本就不懂自己的行业，或者根本不能代表最终用户，不知道自己的需求到底是什么。往往就是一句话：你先做出来再说。所以无意义的需求变更过于频繁，甚至有可能彻底推翻重来。而且这些甲方都是恨不能XP用一辈子的人，他们见不得任何新颖的设计。比如你用了现代化的前端，他们反而不买账，就觉得老界面舒服。你用Spring Boot了，他们认为你连Tomcat都不知道，反而觉得你太Low。这就更进一步助长了公司内部一些不思进取的人，他们拿着尚方宝剑说：用户不认可这样！</li><li>项目招标同质化竞争，明着互相压价、暗着陪标围标等各手段都上。一家公司提出免费维护三年，另一家就可能提出免费维护五年。反正不管将来怎么样，先要把这个项目拿下来再说。最后项目工期可能是合同上的两倍，而且还要面临着验收后好几年的维护期。维护期往往就需要搭一个人进去，没有任何利润可言。最后造成项目整体式亏本，能收支平衡就不错了。</li><li>不像互联网应用那样，客户是网民，没有地域限制。企业应用的客户很可能不在公司本地。客户需要人员驻场开发才放心，我花了钱了就要见到你们的人，否则我怎么控制进度，我怎么知道你们是不是用最后两个月突击完成的。所以差旅住宿成本飙升。为了能有新项目收入，就必然不惜血本继续拿新项目。然后新项目又不断压价，造成恶性循环。</li><li>公司成立之初，可能有几个骨干技术人员。随着公司慢慢发展，他们就成了技术副总、技术总监、技术经理什么的技术管理层。但是这些人基本不会自我提升，而是想着如何继续把公司的技术把控在自己手里，让自己永远坐在过去的功劳簿上。所以他们就禁止技术升级，禁止他们不会的任何技术出现。这样他们才有用，他们才能管理新入职的程序员。</li><li>公司不重视技术，也就不重视技术人员。技术人员永远是三等公民，远没有销售的地位高，也不如财务、行政等职能部门那些会拍马屁的。程序员在项目的投标、实施的整个生命周期中没有话语权。投标时，销售为了中标就胡乱承诺功能和时间进度，根本不会和实际开发的技术人员商量。往往只是给技术总监打个招呼，而技术总监不会考虑底层程序员的利益。实施中，面对客户的需求变更，销售和技术管理层不会和用户讨论需求变更的原因和合理性，而是会配合用户软硬兼施让程序员去实现。</li><li>在企业应用的公司里，除了程序员以外，所有人对软件开发的理解就是堆代码搬砖头，人月神话在他们这里一次一次真实上演。一堆砖头，4个人6个月能搬完，6个人4个月也可以，上12个人就可以用2个月完成！所以从老板到销售到技术总监，一遇到进度问题首先想到加人。不管是需求的原因还是技术上的困难，能给你加人就是对你最大的恩赐。</li><li>为了降低人力成本，也为了让客户看到自己公司人多，所以就招聘低水平的研发。本来应该招聘一个两万四的，但更愿意招聘两个一万二的，最后招聘的是三个八千的。这些人谈不上架构水平、代码质量、自测什么的，造成项目交付质量极差，往往让客户充当了测试的角色。这就进一步让客户对公司产生怀疑，认为公司没有全力投入，就要求你驻场开发。</li></ol><p>总之，所有的这些因素都在不断恶性循环。循环的结果就是：<b>做企业应用的公司可能会发展变大，但是不会变强。变大是因为研发和后期维护人员摊大饼式扩展。不会变强是因为技术常年不会有任何变化，人员层次常年不会有任何提升。没有人从提升技术水平和开发效率的方向去考虑问题，都在想如何拿更多的项目、如何跟客户玩游戏。</b></p><p>多说两句：</p><p>我毕业19年，一半时间在开发企业应用的公司。经历过几百上千人的国企，也经历过十几个人的小私营公司。面对的行业有政府、电网、电信、民航等等。09年以前是Weblogic平台国内专家，后来主要是Spring+前端。现在还在给多家企业做技术咨询顾问，帮助他们整体技术提升。这19年，我从未见上面的恶性循环趋缓，而是还在不断恶化下去。</p><p>每一个有点理想的做企业应用的公司或老板都有一个梦，就是<b>产品化。</b>说白了就是能把产品刻成光盘卖(当然这是传统的做法，现在方网上下载也行)。因为只有这样才能突围出怪圈，走上由大变强之路。这需要公司有非常深厚的行业经验，了解用户的想法，抓住用户的痛点，从中总结和归纳出通用需求。需要有非常强的架构和设计能力，让产品可以按需裁剪、灵活定制。需要有非常强大的编码和测试水平，让产品能够稳定顺畅。</p><p>为了能够实现产品化，但又要面对现有技术水平太差的现状，很多公司就采用项目养产品的策略。就是专门成立一个产品部门或团队，从其他项目组抽调技术人员，或者新招聘几个所谓的高手，集中力量研发产品。</p><p>产品研发是一个周期长、成本高、风险大的工作，而且在真正出来满意产品前是不挣钱的，只能靠项目赚的钱来输血。这种策略往往都是失败的，因为没有一个公司有实力、有耐心去长时间养着一个不挣钱的团队。所以，几乎没有公司能实现这个梦想，都会重新回到摊大饼的老路上。</p><p>这几年一线城市生活、租房等成本飙升，而且必然会传导到程序员的薪资要求上。原来社保福利能不上的不上，必须上的按最低标准上。以后社保由税务部门统一征缴(现在暂缓实施)，那就逃不掉了。所以，最近几年会有大批做企业应用的公司裁员或完蛋。因为研发人力成本是公司经营成本中最大的一部分，这部分成本在加速上升。原来活的好的公司会面临巨大压力，原来活不好的公司会面临死亡。</p><p>本回答中的一些观点可以参考我之前的几个回答。</p><p>企业软件开发考古断代学：</p><a href="https://www.zhihu.com/question/298223034/answer/521330600" data-draft-node="block" data-draft-type="link-card" data-image="https://pic4.zhimg.com/v2-dad7fd2d52c5c0126bb7a5d0a2c0078f_120x160.jpg" data-image-width="1080" data-image-height="1920" class="internal">现在(2018-10-12)还有必要学SSH框架吗?</a><p>三体智子理论：</p><a href="https://www.zhihu.com/question/23321862/answer/470819675" data-draft-node="block" data-draft-type="link-card" class="internal">为什么国内 IT 公司 leader 以上就不怎么写代码，而据说 Google 的 Jeff Dean 还写代码？到底哪种情况好呢？</a><p><br></p><h2>上面说的是公司，下面咱们说说技术和技术人员</h2><p>面对企业的负责人，我经常描述一个场景：有一个工地，几百号人在用铁锹铲子挖坑。我找上门去，问工头：你们知道有一种设备叫挖掘机吗？有的不知道，有的知道。有的以前在别的工地见过或开过，只是来这边以后没机会用了。如果我开一辆挖掘机来，用一天时间干的活就相当于你们这一个工人一个月的工作量，你相信吗？而更重要的是这个挖掘机是免费开源的，不用花钱买，仅仅需要学习掌握如何操作。</p><p>这几百号人的工地就是企业应用项目实施团队。而我说的挖掘机就是Spring Boot + 前端(Angular/React/Vue)，当然也就是我现在推广的JHipster。</p><p>正像我上面场景里描述的那样，有很多技术负责人和普通Java程序员都知道Spring Boot和前端框架。但是对于他们来说有点遥远了，可望不可即。有的Java程序员自己在偷偷学，跃跃欲试，但是这种技术氛围的公司不可能给你实践的机会。有的技术负责人也认识到了新技术能够为公司技术带来的提升，但是苦于自己也不会，更没有能力对下属培训和指导。如果新招聘会的人，自己连面试问什么问题都不清楚，又怕招聘来个水货。总之这些所谓的“新技术”对企业应用市场造成了一定的冲击，但企业自身却有各种困难无法把新技术转换成真正的生产力。</p><p>我会给一家企业介绍讲解现在主流技术栈，并且给他们的员工培训。还会让他们自己找一个典型的业务模块让我用新技术去重新实现，然后把新技术实现和他们以前老技术实现作对比讲解。这些过程完成以后，他们都会认同铁锹铲子和挖掘机之间的差距。这时他们就会在内心深处面对另一个难题：破梦。</p><p>什么是破梦？就是打破程序员的梦，把他们从舒适区赶出来。</p><p>之前说过，每一个有理想的企业软件公司都有一个梦，就是产品化。而公司里的Java程序员也有一个梦，就是手头会的东西能用一辈子。自己永远待在思想的舒适区里，不想动脑子，不想转换思想，只想日复一日做重复的工作。有一句话是叫：没有公主命却有公主病，这里应该是：不是铁饭碗的命，却做着铁饭碗的梦。</p><p>这个梦比公司的梦更容易实现，不用花一分钱，不用开一次会议。有适当的土壤和水分，种子就会发芽，而做企业应用的公司就满足这些条件。可怕的是，这个梦是集体的梦，而不是一个人的梦。如果只是一个人的梦，这个人会被淘汰。如果成为集体的梦就会开始逆淘汰，那些不断提高自己不断学习接受新技术的人会被“淘汰”。</p><p>在我见过的多家公司，这个梦已经实现了。</p><p>加班？不愿意啊...  但可以接受！</p><p>出差？不愿意啊... 但可以接受！</p><p>薪资没有互联网公司高？不愿意啊... 但可以接受！</p><p>学习现在的主流技术栈，提升开发效率？不愿意啊... 不但不能接受，还有很多理直气壮的理(谎)由(言)拒绝你！</p><p>下面三个谎言比较常见：</p><p>1，这个技术不适合企业应用！</p><p>说这句话的人，大部分认为某项技术只适用于互联网。他们简单的认为互联网和企业应用在开发上有很多不同，而很多技术天生就被打上了不同的标签。但实际情况不是。</p><p>没有专为互联网应用开发的Spring Boot，也没有专为企业应用开发的SSM/SSH。没有专为互联网应用开发的React，也没有专为企业应用开发的Angular。</p><p>没有一家互联网公司只有为普通用户开发的界面。滴滴不可能只有给乘客和司机用的两个App。阿里巴巴集团，上到马云下到普通员工，不可能成天顶着天猫和淘宝界面浏览。他们都有自己的中后台系统。蚂蚁金服的内部，也不是天天只访问支付宝界面。</p><p>就蚂蚁金服的中后台系统复杂的就不亚于一个国有商业银行，腾通的中后台系统绝对不会比电信的简单。</p><p>最近在给多家企业推广Ant Design。当然们看到Ant Design文档中这段话时，深表认同：</p><blockquote>蚂蚁的企业级产品是一个庞大且复杂的体系。这类产品不仅量级巨大且功能复杂，而且变动和并发频繁，常常需要设计与开发能够快速的做出响应。<br>从 2015 年 4 月起，Ant Design 在蚂蚁金服中后台产品线迅速推广，对接多条业务线，覆盖系统 800 个以上。<br></blockquote><p>有做企业应用的公司有800个系统吗？蚂蚁金服的中后台产品线有，而且还仅仅是已经推广了Ant Design的。</p><p>2，这个技术不成熟！</p><p>事实是他根本没有去深入了解这个技术。往往当他说完这话之后就不会再和你继续讨论了，他说这句话的同时就算是给你最盖棺定论了。</p><p>不成熟的技术，当然不在公司乱用，万一影响到项目进度和质量，谁能付得起责任？</p><p>不愿意花时间去深入了解一项技术，不勇于“试错”，有怎么知道这项技术不成熟呢？</p><p>就像我在这个回答中说的一样：</p><a href="https://www.zhihu.com/question/290103721/answer/479076978" data-draft-node="block" data-draft-type="link-card" data-image="https://pic3.zhimg.com/v2-d7d21234951efdb41c376d6cffd0d412_180x120.jpg" data-image-width="1272" data-image-height="752" class="internal">2018年已过一半，为什么绝大部分前端团队还是无法重视Angular？</a><p>不了解的就是不成熟的，不成熟的就是不能用的，不去用就永远不了解。这个死循环永远打破不了。</p><p>3，这个东西太难用！</p><p>有些技术，因为他们听的太多了，耳朵都磨起茧子了。或者是别人强迫他们去学习了解的。当他们遇到一点点困难就甩出这句话，然后就没有然后了。</p><p>在我的多个回答里，反复强调一句话：软件开发首先是思想活动，其次才是敲打吗。</p><a href="https://www.zhihu.com/question/296008861/answer/614972836" data-draft-node="block" data-draft-type="link-card" data-image="https://pic1.zhimg.com/v2-edf74ffb02e7d12b1e1e5da0d1213474_180x120.jpg" data-image-width="600" data-image-height="400" class="internal">到底存在不存在不适合学编程的人？</a><p>思想最难的就是转变。一个新技术或新框架，往往是因为旧技术或框架无法支撑其新的思想才出现的。或者说，新技术就是代表了新思想。技术的进步就是思想的进步。</p><p>可是有些人学习一个新东西，就是要往自己已经会的东西上套。套不上就是难用！可是完全套上了又和之前的东西有什么差别呢？</p><p>我们在参加工作前，做了十几年“学生”，难道不就是学习“生”疏的东西吗？学习就是转变思想的过程。学习一个新技术新框架，就是跟着作者的思想在想问题。想明白想通了，处处顺风顺水。想不通，觉得别扭，开发也束手束脚。</p><p><br></p><p>回到前面我们说的铁锹铲子和挖掘机的话题上来。当企业负责人意识到挖掘机对自己生产力会有变革性的提升时，他们就会在内心深处面对这样一个难题：公司内程序员的梦怎么破？那些理直气壮的谎言怎么才能揭穿？</p><h2>下面回复评论区的一些观点</h2><h3>回复评论区 <a class="member_mention" href="http://www.zhihu.com/people/4ea70fb675a2cf6ef07d1c2b80f73291" data-hash="4ea70fb675a2cf6ef07d1c2b80f73291" data-hovercard="p$b$4ea70fb675a2cf6ef07d1c2b80f73291">@井田</a> 和 <a class="member_mention" href="http://www.zhihu.com/people/b8c695cb3851fd068fe3791cf2da2493" data-hash="b8c695cb3851fd068fe3791cf2da2493" data-hovercard="p$b$b8c695cb3851fd068fe3791cf2da2493">@契蛾</a> ：</h3><blockquote>莫名其妙的回答。企业软件要的是业务，根本不是开发技术，国内用友、金蝶等公司用java开发的erp只能在外围当做数据字典使用，真正下到生产实际中连20多年前的pb开发的程序都替代不了。<br>企业应用场景 技术从来不是重点。<br></blockquote><p>这是企业软件行业常见的谎言和借口之一。企业应用就是面向某个特定行业开发定制化的软件，所以关注业务很重要，这个没错。但并不是说根本不是开发技术，或者技术从来不是重点。</p><p>我本文说要用新(其实一点也不新，而是主流，只是对于某些公司来说永远新)技术，目的不是替代20年前的程序，而是提高企业自身的开发效率，并且降低成本。</p><p>我们就不说新技术能够给开发带来多少便利，能够让原来无法实现或很难实现的需求变得多么容易，能够让用户体验度提升多少。这些都属于你给一个没见过电的人描述电能如何改变生活一样，他始终认为蜡烛和煤油灯能满足自己的需要。我们下面单从很多公司能否活下来这个角度看看技术的重要性。</p><p>一家企业软件公司，技术人员占比多大？一个有三五年经验的Java程序员薪资是多少？五到十年所谓老Java开发薪资是多少？本公司的行政、财务、市场等职能部门的人干到退休可能都拿不到他们现在的薪资。所以，在一家企业软件公司，技术人员的薪资是人力成本的大头，绝对的大头。因为他们人数占多，平均薪资又高。</p><p>如果我通过技术升级能让一家企业软件公司的研发人员数量减少一半，同时效率提升一倍，你觉得企业老板乐意吗？当然乐意，而且是梦寐以求的。一个薪资是一万五的程序员，社保和各种福利算上，企业实际承担两万。开源节流，省下来的钱也是钱。这还不算由于人员减少一半带来的水电、租用办公面积减少等的费用节约。</p><p>事实上可以做到通过技术升级，让企业软件公司的研发数量减少一半，同时效率提升一倍吗？通过我这几年的经历证明是可以的，而且这个目标还是保守的。</p><p>所谓的技术升级，不仅仅是从现在企业软件公司万年不变的JDK6 + SSH/SSM + JQuery/LayUI + MyEclipse升级到Java 8 + Spring Boot + Angular + IDEA。而是整个软件开发流程、思路的改变，是整个软件开发观念的改变。</p><p>就好像我上文描述的场景。并不是从铁锹铲子换成挖掘机就完事了，而是由于挖掘机等现代化作业设备的出现，改变了施工的工序和管理制度。对于开发企业软件的公司来说，开发思想和理念的升级，比纯粹升级换代技术要更难！</p><p>在做企业应用的公司，经常有人“语重心长”的说业务才是最重要的。仅仅是因为他们感觉自己略微比别人多一点行业经验而已，我跟你比不了技术，我在这家公司多待了几年，比你接触业务多，我就和你比这些。每个公司确实都需要行业专家、领域专家，但是这些懂业务的专家应该和技术分开。他们只需要用自己的经验和用户沟通，然后用文档清晰明确的描述需求，而实际情况是项目经理要求既懂业务又要带头干活。业务和研发的分开，才能保证业务更精通与业务而不被技术所累。才能保证技术人员的正常流动，避免去别的行业又不熟悉业务，只能受困于一个行业。</p><p>经常有人在知乎上抱怨“面试造火箭、入职拧螺丝”。我不相信那些能懂Java底层虚拟机、多线程，能搞清楚Spring的IoC、依赖注入、分层结构，能搞清楚各种算法的程序员搞不明白那些业务。仅仅是他们不想把时间和精力用在业务上，他们觉得自己不会长时间在这个行业干，<b>技术才是能带走的东西，业务会扔在老旧的项目里一起埋葬</b>。他们会买一本Java的书看，会买一本前端的书看，会买一本算法的书看，会上知乎提技术问题，哪怕会上CSDN翻翻博客也好，他们绝不会花时间主动去研究业务！</p><h3>回复评论区 <a class="member_mention" href="http://www.zhihu.com/people/586747aa93b5fa2e2c340b9ebba69907" data-hash="586747aa93b5fa2e2c340b9ebba69907" data-hovercard="p$b$586747aa93b5fa2e2c340b9ebba69907">@lzclong</a>：</h3><blockquote>企业应用里面技术要为业务服务，就像你自己说的技术的升级换代能节省企业成本改变企业文化，但是确实很难苟同你所谓的“技术才是能带走的，业务会随着老旧的项目一起埋葬”。试问不懂核心业务，你怎么判断所谓的多线程设计是不是合适？片面的割裂技术与业务的思路都是不可取的。<br>同意你的让业务和技术更专业。<br>但是在一家专注做企业应用的公司里面，80%的团队成员不能仅仅把自己定位于技术人员，技术人员不吃透业务应用场景，基本上都会陷入老虎吃天无从下口或者不负责任制造无用、低效率代码的地步。 纯技术人员从来都是那20%（或者更低比例）的金字塔尖的一波人。<br><br></blockquote><p>昨天晚上花了好长时间回复你，可是睡觉了才发现内容没有保存上。现在重写。</p><p>我没有否定业务的重要性，我也同意要有吃透业务的人。我的观点是分离，不是分割。分离是让业务专注于业务，让技术专注于技术。</p><p>业务人员甚至可以不是计算机专业的，甚至可以不会编程。他们可能是行业内对口专业的，也可能是在行业内深耕多年积累丰富经验的，也可能是行业内退休的专家被聘来做业务分析和指导。</p><p>在项目初期，主要是业务人员在分析和分解业务，最终的成果就是设计文档。设计文档能够让技术人员纯粹用技术的视角就理解任务就知道该如何去实现功能。当然肯定不会这么完美，这就需要业务和技术的交流。</p><p>就像前后端分离一样。服务器端不用JSP了，并不是说没人负责界面和用户交互了，而是由更专业的前端框架完成这部分功，然后前后端分工配合实现整个应用。</p><p>我刚毕业的时候，2001-2003年做过两年对日外包。那时候还没用上Struts，就是纯JDK1.3 + JBuilder + JSP/Servlet。每周一，日本人和我们用Yahoo! Messenger 视频会议，把这周要开发的任务讲解一下。如果有我们不懂的业务，他们会给我们解释。我们要在周五下班前把本周开发并自测过的代码发给日本人。日本人利用周末的时间测试我们的代码。下一个周一会先把周末他们测试的结果给我们，然后继续讲这周的开发任务和业务讲解。我们先把测试的Bug改了，然后开发本周的功能。就这样循环滚动下去。</p><p>我没有从日本人那里学到什么Java编程技术，但是却在这种工作模式上深受启发。两组语言不通的人，隔着那么远的距离，仅仅靠翻译就能协同工作的如此顺畅。日本人把软件开发任务分解的非常合理，每一小部分的需求描述的非常清晰形象。就像流水线上的工人一样，他甚至无需知道最终生产出来的产品是什么样子，只需完成好自己这一道工序的操作就好。这就是任务分解，而任务分解的前提是设计清晰，能够细化，能够形象描述。</p><p>对日外包前，我已经考取了SCJP(Sun Certified Java Programmer)。对日外包做完以后，我认为架构和设计能力很重要，所以自己又学习并考取了SCEA(Sun Certified Enterprise Architect)认证。在SCEA的学习过程中，我发现UML不就是业务和技术之间的桥梁吗？UML就是让不懂编码的人能够通过图形的方式分析业务，然后清晰明确的描述业务。</p><p>UML里面的图形分成两类吧(Structural UML diagrams和Behavioral UML diagrams)。其中Behavioral UML diagrams里面的Activity diagram、Sequence diagram、Use case diagram、State diagram等等，不就是让不懂开发的人分析、描述、确定业务的吗？Structural UML diagrams里的Class diagram、Package diagram、Object diagram等等才是懂面向对象概念的程序员用的啊。</p><p>后来我开始接触Weblogic Platform，对Server、Portal、Integration都熟悉了，后来进一步熟悉了Weblogic Aqualogic。发现BPMN图形语言更丰富，更适合描述复杂业务流程！</p><p>之前我举了一个流水线的例子。我再举一个例子。某建工集团的工人。这个建工集团总包了一个普通居民楼的工程，这些工人去了能建造出一栋栋居民楼来。下次这个建工集团可能会总包一个鸟巢水立方的工程，还是这些工人去了能把鸟巢水立方建出来。再下次，如果他们去建造大裤衩，还是能完成任务。<b>这其中的关键在于设计能力，以及设计的层层细化能力，是一个产业成熟的标志。</b>绝对不会要求每名工人既懂居民楼的业务，还要懂最现代化的体育场的业务。当然，你也会经常见到有设计师对着图纸在施工现场。当然，鸟巢水立方引入了很多最新施工工艺，需要对工人做一些特殊说明。这就是我之前说的业务和技术之间需要配合和交流。</p><p>UML图和专门用来分析复杂业务流程的BPMN都是行业标准了，但是却被我们搁置在一边。让每名工人都既懂得设计和建造大裤衩有能设计和建造普通居民楼。要么你的职业生涯就老老实实困在我这里建造居民楼，去别的地方你不懂业务。这写都是产业不成熟的表现。</p><p><br></p><p>说到分离，再多说几句。</p><p><b>做企业应用的公司害怕分离</b>，总以为都掺在一起才是最直接最省事的，分离就是自己给自己找麻烦，就是脱了裤子放屁。<b>但事实是相反的。</b></p><p>我现在能想起三个层面的分离，很多数公司都不能同时做好。能实现一个层面的分离已经是难为他们了。</p><p>1，前后端分离。老生常谈了，我自己都烦了。不多说，多看看我其他相关回答。</p><p>2，人员分离。上面讲的就是，但不仅仅局限于此。还应该包括前端人员、服务器端人员、测试人员等等的分离。往往在一家公司，业务、(如果分前后端的话)开发、测试都是一同组人。</p><p>3，环境分离。严格区分开发(dev)、测试(test)、演示模拟(staging)、产品(prod)环境。最低要求是分为开发、产品两个环境。</p><p>充分利用Spring的指导思想和提供的特性，分成application-dev.properties(yml)和application-prod.properties(yml)两个配置文件。</p><p>比如我就禁止研发人员在自己的电脑(尤其是笔记本)上装数据库。因为这台机器是开发环境，有H2这类专门用在开发环境的数据库呢。见过太多程序员把Oracle、SQLServer装在自己的笔记本上，然后成天喊太卡，要求公司加内存。</p><p>最后的所谓发布和部署，就是把笔记本上的代码复制一份到客户服务器的Tomcat下。简单、省事、一步到位，这就是我们企业应用开发最聪明之所在。</p><p>现在的前端开发也要用webpack配置开发和产品，开发环境方便调试、热加载、测试，产品环境会优化、混淆、压缩。从开发到产品要npm build一下，这让企业开发的人觉得不可思议。干嘛要这么复杂？不就写个JS吗？</p><p><b>做企业应用的公司也不愿意统一，</b>总认为统一就是束手束脚，统一就是约束了自由意志，限制了个性的发挥。<b>事实同样是相反的。</b></p><p>我现在能想起三个层面的统一，也没有企业能够都做好。</p><p>1，统一开发环境配置</p><p>我曾经写过一篇文章，介绍Chocolatey：</p><a href="https://zhuanlan.zhihu.com/p/53421288" data-draft-node="block" data-draft-type="link-card" data-image="https://pic3.zhimg.com/v2-5516e2e66847ae51dbb4a9cd4db0424e_180x120.jpg" data-image-width="1280" data-image-height="720" class="internal">：Windows统一开发环境的基础-Chocolatey</a><p>公司应该给出一个明确的开发软件配置列表，包含用到的所有软件，以及他们的最低版本和基本配置。其实现在的Java服务器端开发机器只需要JDK和IDE就可以了，不需要安装Tomcat、Maven、数据库。可以参考我这篇文章：</p><a href="https://zhuanlan.zhihu.com/p/59663308" data-draft-node="block" data-draft-type="link-card" data-image="https://pic1.zhimg.com/v2-247453df53b9d0b6669a0fa673a9d54c_180x120.jpg" data-image-width="1200" data-image-height="675" class="internal">：不装Maven、Database、Tomcat 才是Spring Boot的正常开发模式</a><p>见过太多人把JDK或IDE装到类似 G:\\学习资料\\Java\\开发工具\\ 这种路径下面。见过无数次“为什么在我这能跑，在你哪里就不能跑了”的怪现象。由于路径含有中文或空格引起的错误，由于安装路径和版本不同造成运行差异的问题，都屡见不鲜。</p><p>在这些统一的基础上，其他可以自己定制。例如你喜欢暗色编辑界面，他喜欢亮色编辑界面。因为这些不会影响到开发。</p><p>2，统一代码风格</p><p>这个就不说了吧，大家都知道，但是没有公司能做到位的。找一套编码风格规范很容易，但是让每个人都养成习惯太难，定期有人做代码复查就更难了。</p><p>3，统一组件库</p><p>公司内用什么第三方库，最好有统一的要求，需要升级的时候统一升级。</p><p>前端用jQuery、Underscore/Lodash，要求统一到什么版本。用了Select2/Chosen，需要用某一个版本。等等不再例举。当然如果用现代化的前端开发，比较容易用package和package-lock统一版本。服务器端最好有自己的Maven库，用Nexus很容易就能搭建。</p><p><br></p><p>上面讲的害怕分离和不愿统一，总结起来的根源就是：习惯原始小作坊化、逆工程化。机械、建筑、纺织、电子、哪怕是某些国家的农业都早已进入了现代工业化大生产阶段。但是软件开发，特别是企业软件开发还将长期停留在小作坊阶段。</p><p>什么是工业化大生产？</p><p>工业化就是专业分离。一家大飞机的几万个零件，又全球不同国家不同企业研发制造。一个零件，要经过若干道复杂的工序才能出厂。你们不是号称自己精通业务吗？你们看看自己熟悉的行业是如何分工的。不分工明细，何来如此复杂的业务流程。</p><p>工业化就是标准统一。只有标准集装箱，才能促进全球贸易往来。只有统一的铁轨才能让火车跑起来。只有统一的电压和频率才能让大家放心购买电器。你们不是号称自己精通业务吗？你们看看自己熟悉的行业都有多少标准！我经历过国家电网、电信、民航等行业，标准繁多啊。</p><h3>回复评论区 <a class="member_mention" href="http://www.zhihu.com/people/ce6e9eda9a76a07c1af6f37d140e8ec0" data-hash="ce6e9eda9a76a07c1af6f37d140e8ec0" data-hovercard="p$b$ce6e9eda9a76a07c1af6f37d140e8ec0">@还是无聊的人</a>：</h3><p>做企业应用的人到现在的习惯思维还是JSP，不让用JSP了就想到Thymeleaf，反正思维总是局限在服务器端。而我们必须要认识到，以前前后端分离是一种选项，今后前后端分离则是必须。更多观点看我的这个回答：</p><a href="https://www.zhihu.com/question/21142149/answer/346032466" data-draft-node="block" data-draft-type="link-card" class="internal">Java新手如何学习Spring、Struts、Hibernate三大框架？</a><a href="https://www.zhihu.com/question/306193181/answer/556626638" data-draft-node="block" data-draft-type="link-card" data-image="https://pic2.zhimg.com/v2-6f644ba30f84fd4d5d12a7f474ecd8e5_180x120.jpg" data-image-width="1566" data-image-height="896" class="internal">Java Web 开发使用 jsp 页面是否已经落后了？是的话现在流行用什么？</a><p>因为企业应用脱离不了Spring，不管现在是SSH还是SSM都在Spring的体系内，下一步升级也必然不会脱离Spring生态，而Spring Boot是必然的选择。Spring Boot是Spring现在最重要的项目，也是Java服务器端近些年唯一跟上时代的亮点。更多观点看我的这个回答：</p><a href="https://www.zhihu.com/question/284488830/answer/618290880" data-draft-node="block" data-draft-type="link-card" data-image="https://pic4.zhimg.com/v2-f5a4794a09b20334c8394c4f91041803_ipico.jpg" data-image-width="883" data-image-height="870" class="internal">spring boot和SSM开发中有什么区别？</a><a href="https://www.zhihu.com/question/49649311/answer/364216794" data-draft-node="block" data-draft-type="link-card" data-image="https://pic2.zhimg.com/v2-110acebb722760d0c4d31b409fdd8ca9_ipico.jpg" data-image-width="1164" data-image-height="996" class="internal">哪些企业或项目在用Spring boot,或者它会在多大程度上替代Spring?</a><p>Spring Cloud也是构建与Spring Boot之上的，所以Spring Boot是今后架构迁移到微服务的必由之路。更多内容看我这个回答：</p><a href="https://www.zhihu.com/question/47304987/answer/627831450" data-draft-node="block" data-draft-type="link-card" data-image="https://pic1.zhimg.com/v2-ef2e22e0b86d05ddbbc99a0eb438f6a8_180x120.jpg" data-image-width="720" data-image-height="543" class="internal">Spring boot与Spring cloud 是什么关系？</a><p>Spring Boot本身对JSP就有一定的限制，当架构迁移到Spring Cloud的时候，JSP就彻底无用了。因为所有的前端都必须发送AJAX请求给Spring Cloud的API Gateway。</p><p>所以，<b>以前用SSM/SSH，JSP是主流，前后端分离是可选。用Spring Boot，前后端分离应该是首选。用Spring Cloud，前后端分离是必须！</b></p><h3>回复评论区 <a class="member_mention" href="http://www.zhihu.com/people/0470abedf708136342881debf7016561" data-hash="0470abedf708136342881debf7016561" data-hovercard="p$b$0470abedf708136342881debf7016561">@moshanglalaxy</a> :</h3><blockquote>刚开始读前面我一直以为我就是这种陈旧的人，后来你说挖掘机是springboot？.....我居然这么先进了吗</blockquote><p>如果Spring Boot是挖掘机的话，那仅仅是挖掘机。现代施工作业不仅仅靠挖掘机，还有很多工程机械合使用，搅拌机、打桩机等等。</p><p>所以前提是Spring Boot这个的挖掘机要使用正确。不能开着挖掘机心里想着铁锹的操作要领。就像我上面回复评论区中说的，用Spring Boot还在想JSP或其他模板语言，否则就不会用了。</p><p>其次，Spring Boot要和前端框架配合好，利用好REST API，做到前后端分离的开发。而且为将来有可能的微服务迁移做好准备。</p><p>Spring Boot解决了服务器端各种框架的集成配置问题，而JHIpster包含Spring Boot，并给你了前后端最佳搭配的样板。</p><h3>回复评论区 <a class="member_mention" href="http://www.zhihu.com/people/752c7dbcbb72c6a00aa8bdf8123a96e3" data-hash="752c7dbcbb72c6a00aa8bdf8123a96e3" data-hovercard="p$b$752c7dbcbb72c6a00aa8bdf8123a96e3">@黄浩</a>：</h3><p>做企业应用的公司永远谈不上技术，所有的技术都是在迫不得已的情况下被动的接受。为什么Struts2换成SSM？还不是因为现在用Struts的人太少了，不好招人了。培训班都已经不教了Struts了，而是以SSM为主了。喜欢技术、乐于创新的人在这样的公司永远不会发挥自己的优势。项目经理其实就是比别人多几年经验更懂一点业务，然后顶着个“经理”的头衔带头干活的。</p><p>所以，认清了环境后就要分析自己，你适合做技术还是适合混体制。喜欢论资排辈、温水煮青蛙、技术十年如一日，那就好好混。否则，趁年轻多学技术，找机会换环境。</p><p><br></p><h2>我的一些相关文章和回答</h2><p>想学习Spring Boot和前端开发的同学，看我的文章：</p><a href="https://zhuanlan.zhihu.com/p/53182228" data-draft-node="block" data-draft-type="link-card" data-image="https://pic4.zhimg.com/v2-267b2a9c87ea8a047552decee4372997_180x120.jpg" data-image-width="1600" data-image-height="571" class="internal">：从0开始,5分钟创建一个Spring Boot + Angular/React应用</a><a href="https://zhuanlan.zhihu.com/p/59117834" data-draft-node="block" data-draft-type="link-card" data-image="https://pic2.zhimg.com/v2-138f781b91744f985a6443866acdd435_180x120.jpg" data-image-width="620" data-image-height="360" class="internal">：Java EE开发的颠覆者？Spring Boot 十问</a><a href="https://zhuanlan.zhihu.com/p/57221201" data-draft-node="block" data-draft-type="link-card" data-image="https://pic4.zhimg.com/v2-b4222fa3147fe05666dfbc22174ad863_180x120.jpg" data-image-width="2600" data-image-height="1107" class="internal">：跟我一起学Spring Boot + Angular/React全栈开发</a><p></p>Thu, 21 Mar 2019 07:59:48 GMT
https://www.zhihu.com/question/314882583/answer/628619845
https://www.zhihu.com/question/314882583/answer/628619845                                                ']